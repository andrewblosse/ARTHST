---
title: "Main_RMD"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

```{r read-data}
knoedler <- read_csv("knoedler.csv")
knoedler <- knoedler %>%
  filter(object_type == "Painting") %>%
  mutate(price_amount = as.numeric(price_amount))
```

```{r glimpse-data}
knoedler %>%
  count(sell_auth_loc_1) %>%
  arrange(desc(n))
```
```{r year-hist-plot, warning=FALSE}
knoedler %>%
  ggplot(aes(x = sale_date_year)) +
  geom_histogram(bins = 100, fill = "lightblue") +
  labs(title = "Painting Sales vs Year of Sale",
       subtitle = "Paintings sold by M. Knoedler & Co.",
       x = "Year of Sale",
       y = "Number of Paintings Sold") +
  theme_classic()

knoedler %>%
  ggplot(aes(x = sale_date_year, y = price_amount)) +
  geom_point() +
  geom_smooth(color = "green") +
  theme_minimal() +
  labs(title = "Scatterplot of Painting Price vs Sale Year",
       x = "Year of Sale",
       y = "Price in USD") +
  scale_y_continuous(breaks = c(100000, 200000, 300000, 400000, 500000), labels = c("$100,000", "$200,000", "$300,000", "$400,000", "$500,000"))
```

```{r density-plot-sales-price, warning=FALSE}
knoedler %>%
  ggplot(aes(x = price_amount, color = price_amount)) +
  geom_histogram(bins = 50, fill = "darkgreen") +
  scale_x_continuous(limits = c(0, 30000)) +
  labs(title = "Knoedler Painting Sale Prices",
       x = "Price in USD",
       y = "# of Sales") +
  theme_classic()
  
```


