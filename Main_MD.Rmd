---
title: "Main_RMD"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

```{r read-data, include = FALSE}
knoedler <- read_csv("knoedler.csv")
knoedler <- knoedler %>%
  filter(object_type == "Painting") %>%
  mutate(price_amount = as.numeric(price_amount))
```

```{r glimpse-data}
knoedler %>%
  count(sell_auth_loc_1) %>%
  arrange(desc(n))
```
```{r year-hist-plot, warning=FALSE}
 yearhistogram <- knoedler %>%
  ggplot(aes(x = sale_date_year)) +
  geom_histogram(bins = 100, fill = "lightblue") +
  labs(title = "Painting Sales vs Year of Sale",
       subtitle = "Paintings sold by M. Knoedler & Co.",
       x = "Year of Sale",
       y = "Number of Paintings Sold") +
  theme_classic()

year_price_scatter <- knoedler %>%
  ggplot(aes(x = sale_date_year, y = price_amount)) +
  geom_point() +
  geom_smooth(color = "green") +
  theme_minimal() +
  labs(title = "Scatterplot of Painting Price vs Sale Year",
       x = "Year of Sale",
       y = "Price in USD") +
  scale_y_continuous(breaks = c(100000, 200000, 300000, 400000, 500000), labels = c("$100,000", "$200,000", "$300,000", "$400,000", "$500,000"))
```

```{r density-plot-sales-price, warning=FALSE}
 price_histogram<- knoedler %>%
  ggplot(aes(x = price_amount, color = price_amount)) +
  geom_histogram(bins = 50, fill = "darkgreen") +
  scale_x_continuous(limits = c(0, 30000)) +
  labs(title = "Knoedler Painting Sale Prices",
       x = "Price in USD",
       y = "# of Sales") +
  theme_classic()
  
```

```{r dimensions}
common_painting_dimensions <- knoedler %>%
  filter(!is.na(dimensions))%>%
  count(dimensions) %>%
  arrange(desc(n)) %>%
  head(20) %>%
  ggplot(aes(y = dimensions, x = n)) +
  geom_col() +
  labs(title = "Most Common Painting Dimensions",
       subtitle = "Paintings from M. Knoedler & Co. Stock Books",
       y = "Painting Dimension",
       x = "Frequency") +
  theme_minimal()
```

```{r avg-price-per-dim, warning=FALSE}
top20dims <- knoedler %>%
  filter(!is.na(dimensions)) %>%
  count(dimensions) %>%
  arrange(desc(n)) %>%
  head(20)

boxplots <- knoedler %>%
  filter(dimensions %in% top20dims$dimensions) %>%
  select(dimensions, price_amount, price_currency) %>%
  ggplot(aes(y = dimensions, x = price_amount)) +
  geom_boxplot() +
  coord_cartesian(xlim = c(0, 25000)) +
  labs(title = "Boxplots of Sale Prices by Dimension",
       x = "Price in USD",
       y = "Painting Dimensions in Inches")
```

```{r display, warning=FALSE}
#boxplots
#common_painting_dimensions
#price_histogram
#top20dims
#year_price_scatter
#yearhistogram
```

